# A (1 балл). Нимбус минус две тысячи

Очередная игра в квиддич. Когтевранцы выбирают, кто будет представлять их факультет на столь важном событии. Всего есть `N` кандидатов, у каждого метла летает с максимальной скоростью `a[i]`. В силу определенных правил формирования команды можно выбрать обладателей метел с номерами `1, 2, …, l, r, r+1, …, N`.

Когтевранцы уверены, что скорость команды определяется как скорость самой медленной метлы в команде.

---

### Формат ввода

- В первой строке идет число `N` (1 ≤ N ≤ 10⁵) — число кандидатов.
- Во второй строке идут `N` чисел `a[i]` (−10⁹ ≤ a[i] ≤ 10⁹) — скорости метел (не спрашивайте, что такое отрицательная скорость, вы же всего лишь маглы, вам не понять).
- Далее на отдельной строке идет число `Q` (1 ≤ Q ≤ 10⁶) — число запросов скорости команды от капитана.
- Затем следуют `Q` строк по два числа `l[i], r[i]` (1 ≤ l[i] ≤ r[i] ≤ N) — границы i-го запроса.

---

### Формат вывода

Выведите `Q` строк — ответы на запросы.

# B (3 балла, с ревью). Средний шум по теплице

Мандрагоры — безопасные растения, но их корни могут издавать оглушающие звуки. На втором курсе студенты Хогвартса в качестве одного из занятий пересаживают уже подросших мандрагор из маленьких горшков в горшки побольше. Горшки с мандрагорами стоят в ряд, поэтому их пронумеровали от 1 до `N`.

Профессор Стебль рассказала, что каждая из мандрагор кричит с громкостью `a[i]` децибел. Гермиона, как самая одаренная студентка, узнала, что можно за раз пересадить несколько подряд идущих мандрагор, при этом их усредненный шум будет звучать как среднее геометрическое их громкостей по отдельности.

Среднее геометрическое вычисляется по формуле:  
`Среднее геометрическое = (a1 * a2 * ... * an)^(1 / n)`,  
где `n` — количество мандрагор в выбранном отрезке.

---

### Формат ввода

- В первой строке дано число `N` (1 ≤ N ≤ 3 ⋅ 10⁵) — число мандрагор.
- На второй строке идут `N` вещественных чисел `a[i]` (0.01 ≤ a[i] ≤ 10³) с двумя знаками после десятичной точки — громкость i-й мандрагоры.
- На третьей строке идет единственное число `Q` (1 ≤ Q ≤ 10⁵) — число запросов подсчета среднего шума на подотрезке от Гермионы.
- Далее идет `Q` строк запросов в формате `i j` (0 ≤ i ≤ j ≤ N - 1):
    - `i, j` — индексы массива, задающие отрезок для запроса.

---

### Формат вывода

Для каждого запроса на новой строке выведите полученную среднюю громкость с точностью не менее шести знаков после запятой.

# C (2 балла). Очередная суматоха в Отделе Тайн

Отдел Тайн Министерства магии состоит из двух стеллажей `A` и `B`. Известно, что:
- В стеллаже `A` пророчества на каждой полке отсортированы по времени их создания (по возрастанию).
- В стеллаже `B` пророчества на каждой полке отсортированы в обратном порядке (по убыванию).

Стеллаж `A` имеет `n` полок, а стеллаж `B` — `m` полок. Обе стеллажа хранят на каждой полке по `l` пророчеств.

**Особенность пророчеств**:  
Каждое пророчество состоит из двух частей: одна часть хранится в стеллаже `A`, а другая — в `B`. Половинки соединяются следующим образом:  
Для полок `A[i]` и `B[j]`, найдите такое `k`, что `max(A[i][k], B[j][k])` минимально. Если таких `k` несколько, подходит любое из них.

Вам нужно помочь Тому Реддлу искать нужные `k` для его запросов вида `(i, j)`.

---

### Формат ввода

1. Первая строка: три числа `n`, `m`, `l`  
   (1 ≤ n, m ≤ 900; 1 ≤ l ≤ 3000).
2. Далее `n` строк с описаниями полок стеллажа `A`. Каждая строка содержит `l` целых чисел (0 ≤ значение ≤ 10⁵ − 1).
3. Следующая строка: число `m`, затем описание `m` полок стеллажа `B` (аналогично формату для `A`).
4. Следующая строка: число запросов `q` (1 ≤ q ≤ n ⋅ m).
5. Затем `q` строк с парами чисел `i, j` (1 ≤ i ≤ n, 1 ≤ j ≤ m).

Полки и элементы нумеруются с **1**.

---

### Формат вывода

Выведите `q` чисел от `1` до `l` — ответы на запросы. Каждое число соответствует номеру элемента `k` на отрезках полок `(i, j)` для каждого запроса.

# D (2 балла). Минимальный люмос

Трио Рон, Гарри и Гермиона попало в западню. Чтобы открыть дверь, им нужно осветить все `N` приемников, расположенных в ряд. Заклятие «Люмос» способно покрыть светом отрезок длины `ℓ`. Однако, троица может поддерживать одновременно не более `k` активных заклинаний.

Ваша задача — найти минимальное значение `ℓ`, чтобы можно было покрыть все приемники не более чем `k` отрезками.

---

### Формат ввода

1. Первая строка содержит два числа:
  - `n` (1 ≤ n ≤ 10⁵) — количество приемников.
  - `k` (1 ≤ k ≤ n) — максимальное количество заклинаний, которые можно поддерживать одновременно.
2. Вторая строка содержит `n` целых чисел `x[i]` (|x[i]| ≤ 10⁹) — координаты приемников.

---

### Формат вывода

Выведите минимальное значение `ℓ`, чтобы все точки можно было покрыть не более чем `k` отрезками длины `ℓ`.

# E (1 балл). Анализ гонки

Док прибывает на финальную гонку, осознав свою ошибку. Он застал некоторые фрагменты гонки, а именно `n` фрагментов с `l[i]`-й по `r[i]`-ю секунды.

Для того, чтобы провести анализ ситуации и выработать дальнейшую стратегию для победы над Чико и Кингом, нужно объединить все отрезки, которые он видел. Помогите Доку!

---

### Формат ввода

1. Первая строка содержит число `N` (1 ≤ N ≤ 10⁵) — количество увиденных фрагментов гонки.
2. Далее идут `N` строк, каждая из которых содержит два числа `l[i]`, `r[i]` (1 ≤ `l[i]` ≤ `r[i]` ≤ 10⁹) — начало и конец i-го фрагмента.

---

### Формат вывода

1. Выведите число `K` — количество фрагментов гонки после объединения.
2. Затем выведите `K` строк, каждая из которых содержит два числа `l[i]`, `r[i]` — границы i-го фрагмента.

Фрагменты можно выводить в любом порядке.

# F (1 балл, с ревью). k-я порядковая статистика

В этой задаче вам необходимо найти k-ую порядковую статистику (k-ое по неубыванию) числовой последовательности `A`, элементы которой задаются следующим образом:

---

### Формат ввода

1. Даны числа `n`, `k`, `A0`, `A1` (1 ≤ k ≤ n ≤ 10⁷, 0 ≤ Ai < 10⁷ + 4321) — количество чисел в числовой последовательности, номер статистики и первые два числа числовой последовательности.

---

### Формат вывода

1. Выведите k-ую порядковую статистику числовой последовательности.

# G (2 балла, с ревью). Long long LSD

Дан массив неотрицательных целых 64-битных чисел. Нужно отсортировать массив методом поразрядной сортировки LSD по байтам.

---

### Формат ввода

1. Первая строка содержит число `N` — количество чисел в массиве (1 ≤ N ≤ 10⁶).
2. Далее идут `N` строк, каждая из которых содержит одно число — элементы массива.

---

### Формат вывода

Выведите отсортированный массив в порядке неубывания.

# H (1 балл, с ревью). Быстрая сортировка

В этой задаче вам нужно отсортировать массив с использованием метода быстрой сортировки.

---

### Формат ввода

1. Первая строка содержит число `N` (1 ≤ N ≤ 10⁵) — количество чисел в массиве.
2. Во второй строке содержатся `N` чисел, каждое на новой строке, которые нужно отсортировать. Числа не превосходят по модулю 10⁹.

---

### Формат вывода

Выведите отсортированный массив в порядке неубывания.

# I (2 балла). Инверсии

В этой задаче вам нужно найти количество пар `(i, j)`, таких что `i < j` и `a[i] > a[j]`. Обратите внимание, что ответ может не влезать в тип `int`.

---

### Формат ввода

1. Первая строка содержит натуральное число `n` (1 ≤ n ≤ 10⁶) — количество элементов массива.
2. Вторая строка содержит `n` попарно различных элементов массива `A` — целых неотрицательных чисел, не превосходящих 10⁹.

---

### Формат вывода

1. Выведите одно число — количество инверсий в массиве.

